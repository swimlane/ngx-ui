<div class="property-config">
  <div class="header">
    <span>Property Configuration</span>
    <button type="button" class="btn btn-primary" (click)="applyChanges()">
      <i class="ngx-icon ngx-check has-text"></i> Apply
    </button>
  </div>
  <ngx-tabs *ngIf="property">
    <ngx-tab label="GENERAL">
      <!-- PROPERTY NAME -->
      <ngx-input
        *ngIf="!arrayItem"
        type="text"
        name="propertyName"
        [(ngModel)]="editableProperty.value.propertyName"
        [label]="'PROPERTY NAME'"
        [required]="true"
        [hint]="'Must only contain A-Z, a-z, 0-9 or _'"
      >
      </ngx-input>

      <!-- TITLE -->
      <ngx-input
        *ngIf="!arrayItem"
        type="text"
        [(ngModel)]="editableProperty.value.title"
        [label]="'PROPERTY TITLE'"
        [hint]="'A human-readable name for this property'"
      >
      </ngx-input>

      <!-- DESCRIPTION -->
      <ngx-input
        *ngIf="!arrayItem"
        type="text"
        [(ngModel)]="editableProperty.value.description"
        [label]="'PROPERTY DESCRIPTION'"
        [hint]="'A description for the property'"
      >
      </ngx-input>

      <!-- TYPE -->
      <ngx-select
        class="prop-types-formats"
        [filterable]="false"
        [ngModel]="[editableProperty.value.type]"
        (ngModelChange)="updateType($event[0])"
        [required]="true"
        [label]="'TYPE'"
      >
        <ngx-select-option *ngFor="let propType of propTypes" [name]="propType" [value]="propType"> </ngx-select-option>
      </ngx-select>

      <!-- FORMAT -->
      <ngx-select
        class="prop-types-formats"
        *ngIf="editableProperty.value.type === 'string' && formats?.length && !editableProperty.value.enum?.length"
        [filterable]="false"
        [ngModel]="[editableProperty.value.format]"
        (ngModelChange)="updateFormat($event[0])"
        [label]="'FORMAT'"
      >
        <ngx-select-option *ngFor="let propFormat of formats" [name]="propFormat" [value]="propFormat">
        </ngx-select-option>
      </ngx-select>

      <!-- ENUM -->
      <ngx-input
        *ngIf="editableProperty.value.type === 'string' && !editableProperty.value.format"
        type=" text"
        class="new-enum-input"
        [(ngModel)]="newEnumValue"
        [label]="'ADD ENUM VALUE'"
      >
        <ngx-input-suffix>
          <button (click)="addEnumValue()" [disabled]="!newEnumValue.length">
            <i class="ngx-icon ngx-ngx-icon ngx-check"></i>
          </button>
        </ngx-input-suffix>
      </ngx-input>

      <ng-container *ngIf="editableProperty.value.enum?.length">
        <div *ngIf="editableProperty.value.enum?.length" class="enum-edit">
          <div class="tag" *ngFor="let value of editableProperty.value.enum">
            <span>{{ value }}</span>
            <button type="button" (click)="removeEnumValue(value)">
              <i class="ngx-icon ngx-x"></i>
            </button>
          </div>
        </div>

        <ngx-select
          [filterable]="false"
          [ngModel]="[editableProperty.value.default]"
          (ngModelChange)="updateDefault($event[0])"
          [label]="'DEFAULT'"
        >
          <ngx-select-option *ngFor="let value of editableProperty.value.enum" [name]="value" [value]="value">
          </ngx-select-option>
        </ngx-select>
      </ng-container>

      <!-- CONSTRAINS -->
      <div
        class="constrain-row"
        *ngIf="editableProperty.value.type === 'number' || editableProperty.value.type === 'integer'"
      >
        <ngx-input type="number" [(ngModel)]="editableProperty.value.minimum" [label]="'MINIMUM'"></ngx-input>

        <ngx-input type="number" [(ngModel)]="editableProperty.value.maximum" [label]="'MAXIMUM'"></ngx-input>
      </div>

      <div class="constrain-row" *ngIf="editableProperty.value.type === 'string'">
        <ngx-input type="number" [(ngModel)]="editableProperty.value.minLength" [label]="'MINIMUM LENGTH'"></ngx-input>

        <ngx-input type="number" [(ngModel)]="editableProperty.value.maxLength" [label]="'MAXIMUM LENGTH'"></ngx-input>
      </div>

      <div class="constrain-row" *ngIf="editableProperty.value.type === 'array'">
        <ngx-input type="number" [(ngModel)]="editableProperty.value.minItems" [label]="'MIN ITEMS'"></ngx-input>
        <ngx-input type="number" [(ngModel)]="editableProperty.value.maxItems" [label]="'MAX ITEMS'"></ngx-input>
      </div>

      <!-- PATTERN -->
      <ngx-input
        type="text"
        *ngIf="['string', 'number', 'integer'].includes($any(editableProperty.value.type))"
        [(ngModel)]="editableProperty.value.pattern"
        [label]="'PATTERN TO MATCH'"
      >
      </ngx-input>

      <!-- REQUIRED -->
      <ngx-checkbox *ngIf="!arrayItem" [(ngModel)]="required">
        Required
      </ngx-checkbox>
    </ngx-tab>
    <ngx-tab label="EXAMPLE VALUES">
      <div class="examples-container">
        <ngx-orderable-inputs-list
          [data]="editableProperty.value.examples"
          (onUpdate)="updateExamples($event)"
        ></ngx-orderable-inputs-list>
      </div>
    </ngx-tab>
  </ngx-tabs>
</div>
